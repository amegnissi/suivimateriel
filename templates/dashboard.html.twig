{% extends 'baseC.html.twig' %}
{% block css %}
    <style>
        .text-bg-primary {
            color: #fff !important;
            background-color: RGBA(13, 110, 253, 1) !important;
        }
    </style>
{% endblock %}
{% block title %}Tableau de bord{% endblock %}

{% block breadcrumb %}TABLEAU DE BORD{% endblock %}

{% block content %}
    <section class="content">
        <div class="container-fluid">
            <!-- Small boxes (Stat box) -->
            <div class="row">
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box text-bg-primary">
                        <div class="inner">
                            <p>TVM</p>
                            <h3>{{ TVM | length }}</h3>


                        </div>
                        <div class="icon">
                            <i class="ion ion-bag"></i>
                        </div>
                        <a href="{{ path('assurances_fin',{'type':'TVM'}) }}" class="small-box-footer">Plus de détails
                            <i
                                    class="fas
                    fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-success">
                        <div class="inner">
                            <p>VISITE TECHNIQUE</p>
                            <h3>
                                {{ VISITE | length }}
                            </h3>


                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        <a href="{{ path('assurances_fin',{'type':'visite-technique'}) }}" class="small-box-footer">Plus
                            de détails <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-warning">
                        <div class="inner">
                            <p>ASSURANCE</p>
                            <h3>
                                {{ ASSURANCE | length }}
                            </h3>


                        </div>
                        <div class="icon">
                            <i class="ion ion-person-add"></i>
                        </div>
                        <a href="{{ path('assurances_fin',{'type':'assurance'}) }}" class="small-box-footer">Plus de
                            détails
                            <i class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-danger">
                        <div class="inner">
                            <p>Nombre d'affectations</p>
                            <h3>{{ totalAffectations }}</h3>
                        </div>
                        <div class="icon">
                            <i class="ion ion-pie-graph"></i>
                        </div>
                        <a href="{{ path('affectations_index') }}" class="small-box-footer">Plus de détails <i class="fas
                    fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="card card-primary card-success">
                        <div class="card-header">
                            <h3 class="card-title"> Nombre de materiels par catégorie</h3>
                        </div>
                        <div class="card-body table-responsive">
                            <table class="table table-hover table-sm table-bordered table-striped">
                                <thead>
                                <tr>
                                    <th class="col">Type de materiel</th>
                                    <th class="col">nombre</th>
                                </tr>
                                </thead>
                                {% for typeMateriel in pagination %}
                                    <tr>
                                        <td>{{ typeMateriel.libelle ?: 'N/A' }}</td>
                                        <td>
                                            <span class="badge bg-gradient-success">{{ typeMateriel.materiels|length ?: 0 }}</span>
                                        </td>

                                    </tr>
                                {% else %}
                                    <tr>
                                        <td colspan="4" class="text-center text-secondary">Aucun type de matériel
                                            trouvé.
                                        </td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="card card-success">
                        <div class="card-header">
                            <h3 class="card-title">Coût de maintenance par mois</h3>

                        </div>
                        <div class="card-body">
                            <div class="chart">
                                <canvas id="barChart"
                                        style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>
                </div>
            </div>

        </div>
    </section>
{% endblock %}
{% block javascript %}
<script src="{{ asset('adminlte/plugins/chart.js/Chart.min.js') }}"></script>
<script>
  $(function () {

      var areaChartData = {
      labels  : {{ labels|raw }},
      datasets: [{
                label: 'Coût Maintenance (CFA)',
                data: {{ values|raw }},
                pointStrokeColor    : 'rgba(60,141,188,1)',
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                pointHighlightStroke: 'rgba(60,141,188,1)',
                pointRadius          : false,
                borderWidth: 1
            }]
    }
        var barChartCanvas = $('#barChart').get(0).getContext('2d')
    var barChartData = $.extend(true, {}, areaChartData)
   // var temp0 = areaChartData.datasets[0]
    // var temp1 = areaChartData.datasets[1]
    // barChartData.datasets[0] = temp1
  //  barChartData.datasets[1] = temp0

    var barChartOptions = {
      responsive              : true,
      maintainAspectRatio     : false,
      datasetFill             : false
    }
     new Chart(barChartCanvas, {
      type: 'bar',
      data: barChartData,
      options: barChartOptions
    })

    })
 </script>
{% endblock %}
{% block scripts %}
    <script src="{{ asset('cuba/assets/js/clock.js') }}"></script>
    <script src="{{ asset('cuba/assets/js/chart/apex-chart/apex-chart.js') }}"></script>
    <script src="{{ asset('cuba/assets/js/chart/apex-chart/stock-prices.js') }}"></script>
    <script src="{{ asset('cuba/assets/js/chart/apex-chart/moment.min.js') }}"></script>
    <script src="{{ asset('cuba/assets/js/notify/bootstrap-notify.min.js') }}"></script>
    <script src="{{ asset('cuba/assets/js/dashboard/default.js') }}"></script>
    <script>
        // Comma/Separator counter
        (function () {
            const counters = document.querySelectorAll (".counter");
            const speed = 70;

            counters.forEach ((counter) => {
                const updateCount = () => {
                    const target = parseInt (counter.getAttribute ("data-target"));
                    const count = parseInt (counter.innerText.replace (/,/g, "")); // Remove commas from displayed count

                    const increment = Math.trunc (target / speed);

                    if (count < target) {
                        let updatedCount = count + increment;

                        // Format the number with commas for lakh and crore
                        updatedCount = updatedCount.toLocaleString ("en-IN");

                        counter.innerText = updatedCount;
                        setTimeout (updateCount, 1);
                    } else {
                        // Update counter.innerText with formatted target value
                        counter.innerText = target.toLocaleString ("en-IN");
                    }
                };

                updateCount ();
            });
        }) ();
    </script>
    {#    <script src="{{ asset('cuba/assets/js/notify/index.js') }}"></script> #}
    {#    <script src="{{ asset('cuba/assets/js/typeahead/handlebars.js') }}"></script> #}
    {#    <script src="{{ asset('cuba/assets/js/typeahead/typeahead.bundle.js') }}"></script> #}
    {#    <script src="{{ asset('cuba/assets/js/typeahead/typeahead.custom.js') }}"></script> #}
    {#    <script src="{{ asset('cuba/assets/js/typeahead-search/handlebars.js') }}"></script> #}
    {#    <script src="{{ asset('cuba/assets/js/typeahead-search/typeahead-custom.js') }}"></script> #}
    {#    <script src="{{ asset('cuba/assets/js/height-equal.js') }}"></script> #}
    <script src="{{ asset('cuba/assets/js/animation/wow/wow.min.js') }}"></script>
{% endblock %}
